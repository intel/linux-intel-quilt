From 8d37052ca40a7f172e8a0b249a3e0843022bcc76 Mon Sep 17 00:00:00 2001
From: Cezary Rojewski <cezary.rojewski@intel.com>
Date: Mon, 3 Sep 2018 14:42:21 +0200
Subject: [PATCH 018/154] ASoC: Intel: Skylake: Fix hw_params updating for BE

This change fixes regression introduced in 4.20-rc1 kernel base with DAI
management refactor.

Previously existing CODEC-CODEC dais bind routines have been merged into
standard dais binders. Because of this, the amount of paths available
for source and sink widgets has also changed.
skl_tplg_be_set_src|sink_pipe_params cannot use the default -EIO return
value since it is no longer guaranteed that any path contains at least
one connected SKL widget.

Change-Id: I7e41880d24f3c17ed33c823722cc0ad43b2a4ce2
Signed-off-by: Cezary Rojewski <cezary.rojewski@intel.com>
---
 sound/soc/intel/skylake/skl-topology.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/sound/soc/intel/skylake/skl-topology.c b/sound/soc/intel/skylake/skl-topology.c
index 7d4b136ee837..23124cee73b2 100644
--- a/sound/soc/intel/skylake/skl-topology.c
+++ b/sound/soc/intel/skylake/skl-topology.c
@@ -1767,7 +1767,7 @@ static int skl_tplg_be_set_src_pipe_params(struct snd_soc_dai *dai,
 				struct skl_pipe_params *params)
 {
 	struct snd_soc_dapm_path *p;
-	int ret = -EIO;
+	int ret;
 
 	snd_soc_dapm_widget_for_each_source_path(w, p) {
 		if (p->connect && is_skl_dsp_widget_type(p->source, dai->dev) &&
@@ -1785,14 +1785,14 @@ static int skl_tplg_be_set_src_pipe_params(struct snd_soc_dai *dai,
 		}
 	}
 
-	return ret;
+	return 0;
 }
 
 static int skl_tplg_be_set_sink_pipe_params(struct snd_soc_dai *dai,
 	struct snd_soc_dapm_widget *w, struct skl_pipe_params *params)
 {
 	struct snd_soc_dapm_path *p = NULL;
-	int ret = -EIO;
+	int ret;
 
 	snd_soc_dapm_widget_for_each_sink_path(w, p) {
 		if (p->connect && is_skl_dsp_widget_type(p->sink, dai->dev) &&
@@ -1810,7 +1810,7 @@ static int skl_tplg_be_set_sink_pipe_params(struct snd_soc_dai *dai,
 		}
 	}
 
-	return ret;
+	return 0;
 }
 
 /*
-- 
2.17.1


From c058b255d13cb824a4c1ed26616777174974a0ae Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Wed, 17 May 2023 10:32:15 +0800
Subject: [PATCH 07/12] Revert "drm/etnaviv: fix reference leak when mmaping
 imported buffer"

This reverts commit 79815326a516f70af8a79f1a49e50f3efd11a1db.
---
 drivers/gpu/drm/etnaviv/etnaviv_gem_prime.c | 10 +---------
 1 file changed, 1 insertion(+), 9 deletions(-)

diff --git a/drivers/gpu/drm/etnaviv/etnaviv_gem_prime.c b/drivers/gpu/drm/etnaviv/etnaviv_gem_prime.c
index 33974cc57e32a..4aa3426a9ba4b 100644
--- a/drivers/gpu/drm/etnaviv/etnaviv_gem_prime.c
+++ b/drivers/gpu/drm/etnaviv/etnaviv_gem_prime.c
@@ -93,15 +93,7 @@ static void *etnaviv_gem_prime_vmap_impl(struct etnaviv_gem_object *etnaviv_obj)
 static int etnaviv_gem_prime_mmap_obj(struct etnaviv_gem_object *etnaviv_obj,
 		struct vm_area_struct *vma)
 {
-	int ret;
-
-	ret = dma_buf_mmap(etnaviv_obj->base.dma_buf, vma, 0);
-	if (!ret) {
-		/* Drop the reference acquired by drm_gem_mmap_obj(). */
-		drm_gem_object_put(&etnaviv_obj->base);
-	}
-
-	return ret;
+	return dma_buf_mmap(etnaviv_obj->base.dma_buf, vma, 0);
 }
 
 static const struct etnaviv_gem_ops etnaviv_gem_prime_ops = {
-- 
2.25.1


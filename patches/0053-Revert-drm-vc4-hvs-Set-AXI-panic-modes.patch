From ff73a0563fcbed83a4b9d490c564d84572ab50e5 Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Thu, 27 Apr 2023 13:18:14 +0800
Subject: [PATCH 53/68] Revert "drm/vc4: hvs: Set AXI panic modes"

This reverts commit bc65127ba4c0091886811d94c7d46aecfd13c2f1.
---
 drivers/gpu/drm/vc4/vc4_hvs.c  | 11 -----------
 drivers/gpu/drm/vc4/vc4_regs.h |  6 ------
 2 files changed, 17 deletions(-)

diff --git a/drivers/gpu/drm/vc4/vc4_hvs.c b/drivers/gpu/drm/vc4/vc4_hvs.c
index f8f2fc3d15f73..95fa6fc052a72 100644
--- a/drivers/gpu/drm/vc4/vc4_hvs.c
+++ b/drivers/gpu/drm/vc4/vc4_hvs.c
@@ -677,17 +677,6 @@ static int vc4_hvs_bind(struct device *dev, struct device *master, void *data)
 		      SCALER_DISPCTRL_DSPEISLUR(2) |
 		      SCALER_DISPCTRL_SCLEIRQ);
 
-	/* Set AXI panic mode.
-	 * VC4 panics when < 2 lines in FIFO.
-	 * VC5 panics when less than 1 line in the FIFO.
-	 */
-	dispctrl &= ~(SCALER_DISPCTRL_PANIC0_MASK |
-		      SCALER_DISPCTRL_PANIC1_MASK |
-		      SCALER_DISPCTRL_PANIC2_MASK);
-	dispctrl |= VC4_SET_FIELD(2, SCALER_DISPCTRL_PANIC0);
-	dispctrl |= VC4_SET_FIELD(2, SCALER_DISPCTRL_PANIC1);
-	dispctrl |= VC4_SET_FIELD(2, SCALER_DISPCTRL_PANIC2);
-
 	HVS_WRITE(SCALER_DISPCTRL, dispctrl);
 
 	ret = devm_request_irq(dev, platform_get_irq(pdev, 0),
diff --git a/drivers/gpu/drm/vc4/vc4_regs.h b/drivers/gpu/drm/vc4/vc4_regs.h
index a324ef88ceafb..be2c32a519b31 100644
--- a/drivers/gpu/drm/vc4/vc4_regs.h
+++ b/drivers/gpu/drm/vc4/vc4_regs.h
@@ -220,12 +220,6 @@
 #define SCALER_DISPCTRL                         0x00000000
 /* Global register for clock gating the HVS */
 # define SCALER_DISPCTRL_ENABLE			BIT(31)
-# define SCALER_DISPCTRL_PANIC0_MASK		VC4_MASK(25, 24)
-# define SCALER_DISPCTRL_PANIC0_SHIFT		24
-# define SCALER_DISPCTRL_PANIC1_MASK		VC4_MASK(27, 26)
-# define SCALER_DISPCTRL_PANIC1_SHIFT		26
-# define SCALER_DISPCTRL_PANIC2_MASK		VC4_MASK(29, 28)
-# define SCALER_DISPCTRL_PANIC2_SHIFT		28
 # define SCALER_DISPCTRL_DSP3_MUX_MASK		VC4_MASK(19, 18)
 # define SCALER_DISPCTRL_DSP3_MUX_SHIFT		18
 
-- 
2.25.1

